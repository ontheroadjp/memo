<!DOCTYPE html>
<html lang="ja-JP">
        
    <head>
        <link href="https://gmpg.org/xfn/11" rel="profile">
        <meta http-equiv="content-type" content="text/html; charset=utf-8">

        
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

        

        <title>Git ブランチ名を Bash プロンプトに表示する  &middot; MEMO </title>

        
        <link rel="stylesheet" href="https://ontheroadjp.github.io/memo/css/poole.css">
        <link rel="stylesheet" href="https://ontheroadjp.github.io/memo/css/syntax.css">
        <link rel="stylesheet" href="https://ontheroadjp.github.io/memo/css/main.css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

        
        <link rel="manifest" href="https://ontheroadjp.github.io/memo//manifest.json">

        
        <link rel="apple-touch-icon" sizes="180x180" href="/images/mobile/apple-touch-icon.png">

        
        <meta name="theme-color" content="#ffffff">

        
        <link rel="mask-icon" href="/images/mobile/pinned-icon-150x150.svg" color="#5bbad5">

        
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">

        
        <link href="" rel="alternate" type="application/rss+xml" title="MEMO" />
        <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
        <link href='https://fonts.googleapis.com/css?family=Fira+Sans:400,300' rel='stylesheet' type='text/css'>
        <script src="//ajax.googleapis.com/ajax/libs/webfont/1.4.7/webfont.js"></script>
        <script>
            WebFont.load({
                google: {
                    families: ['Fira Sans']
                }
            });
        </script>
    </head>
    <body class="theme-blue">

<div class="sidebar">
    <div class="container sidebar-sticky">
        <div class="sidebar-about" align=center>

            <a href="https://ontheroadjp.github.io/memo/">
                
                    <img src="/memo/images/logo-512x512-white.png" width=50% />
                
            </a>

            <p class="lead">
                 
                    Memos of the WEB Development 
                
            </p>

        </div>

        <ul class="sidebar-nav">
            <li><a href="https://ontheroadjp.github.io/memo//dev">Posts</a></li>
            
                <li><a href="/memo/about/">About </a></li>
            
            <br/> 
            <li>Code:</li>
                 
                 
                 
                 
                 
                 
                 
                 
                 
                 
                 
                 
                 
                 
                 
                 
                 
                 
                 
                 
                 
                 
                 
                 
                 
            
        </ul>

        <a href="https://twitter.com/natethefinch"><i class="fa fa-twitter-square"></i></a>&nbsp;&nbsp; 
        
        
        <a href="https://github.com/ontheroadjp"><i class="fa fa-github-square"></i></a>&nbsp;&nbsp; 
        <a href="https://plus.google.com/&#43;NateFinch"><i class="fa fa-google-plus"></i></a> 

        <p class="footnote">powered by <a href="http://hugo.spf13.com">Hugo</a> <br/> &copy; 2017 Nate Finch. All rights reserved.</p>

    </div>
</div>


    <div class="content container">
        <div class="post">
            <h1 class="post-title">

                Git ブランチ名を Bash プロンプトに表示する
            </h1>
            <nav class="post-meta" style="margin-bottom: 20px">
                <span class="post-date">
                    May 21, 2017
                </span> | 

                
                    
                        <span class="category">
                            <a href="/categories/Tools/">
                                Tools
                            </a>
                        </span>
                    
                

                
                    
                        <span class="tag">
                            <a href="/memo/tags/git">
                                # Git
                            </a>
                        </span>
                    
                        <span class="tag">
                            <a href="/memo/tags/bash">
                                # Bash
                            </a>
                        </span>
                    
                
            </nav>

            

            

<h2 id="test">test</h2>
<div class="highlight" style="background: #202020"><pre style="line-height: 125%"><span></span><span style="color: #6ab825; font-weight: bold">function</span> <span style="color: #d0d0d0">fancyAlert(arg)</span> <span style="color: #d0d0d0">{</span>
  <span style="color: #6ab825; font-weight: bold">if</span><span style="color: #d0d0d0">(arg)</span> <span style="color: #d0d0d0">{</span>
    <span style="color: #d0d0d0">$.facebox({div:</span><span style="color: #ed9d13">&#39;#foo&#39;</span><span style="color: #d0d0d0">})</span>
  <span style="color: #d0d0d0">}</span>
<span style="color: #d0d0d0">}</span>
</pre></div>

<h2 id="やりたいこと">やりたいこと</h2>

<ul>
<li>シェル（bash）のプロンプトに git のブランチ名を表示する</li>
</ul>

<h2 id="環境">環境</h2>

<ul>
<li>Mac OSX Yosemite</li>
</ul>

<h2 id="設定手順">設定手順</h2>

<ol>
<li><code>git-prompt.sh</code> と <code>git-completion.bash</code> の取得 &amp; 設置</li>
<li><code>~/.bashrc</code> の編集</li>
</ol>

<h3 id="1-git-prompt-sh-の取得-設置">(1) git-prompt.sh の取得 &amp; 設置</h3>
<div class="highlight" style="background: #202020"><pre style="line-height: 125%"><span></span>mkdir tmp
<span style="color: #24909d">cd</span> tmp
git clone https://github.com/git/git.git
cp git/contrib/completion/git-prompt.sh /usr/local/etc/bash_completion.d/
cp git/contrib/completion/git-completion.bash /usr/local/etc/bash_completion.d/
</pre></div>

<h3 id="2-bashrc-の編集">(2) .bashrc の編集</h3>

<ul>
<li><code>.bashrc</code> に以下を追加する</li>
</ul>
<div class="highlight" style="background: #202020"><pre style="line-height: 125%"><span></span><span style="color: #24909d">source</span> /usr/local/etc/bash_completion.d/git-prompt.sh
<span style="color: #24909d">source</span> /usr/local/etc/bash_completion.d/git-completion.bash
<span style="color: #40ffff">GIT_PS1_SHOWDIRTYSTATE</span><span style="color: #d0d0d0">=</span><span style="color: #24909d">true</span>
<span style="color: #24909d">export</span> <span style="color: #40ffff">PS1</span><span style="color: #d0d0d0">=</span><span style="color: #ed9d13">&#39;[\[\033[32m\]@\h\[\033[00m\]:\[\033[34m\]\w\[\033[31m\]$(__git_ps1)\[\033[00m\]]\&#39;</span>
</pre></div>

<ul>
<li><code>export PS1=</code> の設定はお好みで</li>
<li><code>$(__git_ps1)</code> が git のブランチ名</li>
<li><code>.bashrc</code> の編集が終わったら <code>source .bashrc</code> を忘れずに</li>
</ul>

<h2 id="表示イメージ">表示イメージ</h2>
<div class="highlight" style="background: #202020"><pre style="line-height: 125%"><span></span><span style="color: #d0d0d0">[</span>@PCName: ~/Vagrant/LAMP/Peach <span style="color: #d0d0d0">(</span>master *<span style="color: #d0d0d0">)]</span>
</pre></div>

<h2 id="シェル起動時に-bashrc-が読み込まれない場合">シェル起動時に .bashrc が読み込まれない場合</h2>

<ul>
<li><code>.bash_profile</code> に以下を追加する</li>
</ul>
<div class="highlight" style="background: #202020"><pre style="line-height: 125%"><span></span><span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">[</span> -f ~/.bashrc <span style="color: #d0d0d0">]</span> <span style="color: #d0d0d0">;</span> <span style="color: #6ab825; font-weight: bold">then</span>
. ~/.bashrc
<span style="color: #6ab825; font-weight: bold">fi</span>
</pre></div>

<hr />

<h2 id="bash-completion-のインストール">bash-completion のインストール</h2>
<div class="highlight" style="background: #202020"><pre style="line-height: 125%"><span></span><span style="color: #999999; font-style: italic"># ダウンロード</span>
wget http://bash-completion.alioth.debian.org/files/bash-completion-1.2.tar.bz2

<span style="color: #999999; font-style: italic"># インストール</span>
tar xvjf bash-completion-1.2.tar.bz2
<span style="color: #24909d">cd</span> bash-completion-1.2
./configure
make
sudo make install
</pre></div>

<p><code>/usr/local/etc</code> に <code>bash_completion.d</code> としてインストールされる</p>

<h2 id="git-prompt-sh-のインストール">git-prompt.sh のインストール</h2>
<div class="highlight" style="background: #202020"><pre style="line-height: 125%"><span></span>wget https://raw.githubusercontent.com/git/git/master/contrib/completion/git-prompt.sh -O ~/.git-prompt.sh
sudo mv /usr/local/etc/bash_completion.d/git-prompt.sh
</pre></div>
<div class="highlight" style="background: #202020"><pre style="line-height: 125%"><span></span>wget https://raw.githubusercontent.com/git/git/master/contrib/completion/git-prompt.sh
</pre></div>

<ul>
<li><a href="http://git-prompt.sh/">git-prompt.sh ダウンロードページ</a></li>
</ul>

<h2 id="git-completion-bash-のインストール">git-completion.bash のインストール</h2>
<div class="highlight" style="background: #202020"><pre style="line-height: 125%"><span></span>wget <span style="color: #ed9d13">&#39;http://git.kernel.org/?p=git/git.git;a=blob_plain;f=contrib/completion/git-completion.bash;hb=HEAD&#39;</span> -O git-completion.bash
sudo mv git-completion.bash /usr/local/etc/bash_completion.d/git
</pre></div>

<h2 id="bashrc-の編集">~/.bashrc の編集</h2>

<pre><code># プロンプトに git のブランチ名を表示する
source /usr/local/etc/bash_completion.d/git-prompt.sh
source /usr/local/etc/bash_completion.d/git-completion.bash
GIT_PS1_SHOWDIRTYSTATE=true
export PS1='[\[\033[32m\]@\h\[\033[00m\]:\[\033[34m\]\w\[\033[31m\]$(__git_ps1)\[\033[00m\]]\'
</code></pre>

<h2 id="bashrc-の読み込み">~/.bashrc の読み込み</h2>
<div class="highlight" style="background: #202020"><pre style="line-height: 125%"><span></span><span style="color: #24909d">source</span> .bashrc
</pre></div>

<h2 id="エラーが出た場合">エラーが出た場合。</h2>

<p>インストールが上手くいってないと、以下のエラーが出る。</p>
<div class="highlight" style="background: #202020"><pre style="line-height: 125%"><span></span>-bash: __git_ps1: <span style="color: #24909d">command</span> not found
</pre></div>

<p><code>/usr/local/etc/bash_completion.d</code> 以下に、<code>git-prompt.sh</code> と <code>git-completion.bash</code> があるか確認する。</p>


             

            <div id="disqus_thread"></div>
<script type="text/javascript">
    (function() {
        
        
        if (window.location.hostname == "localhost") 
            return;
    
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
    
        var disqus_shortname = 'hogecom';
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
    Please enable JavaScript to view the comments powered by 
    <a href="http://disqus.com/?ref_noscript">Disqus.</a>
</noscript>

        </div>
    </div> 

</body>
</html>

